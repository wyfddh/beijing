<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tj720.admin.dao.map.MipActivityMapper" >
  <resultMap id="BaseResultMap" type="com.tj720.admin.model.MipActivity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="activity_name" property="activityName" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="publish_time" property="publishTime" jdbcType="TIMESTAMP" />
    <result column="publisher" property="publisher" jdbcType="VARCHAR" />
    <result column="org_id" property="orgId" jdbcType="VARCHAR" />
    <result column="activity_time" property="activityTime" jdbcType="VARCHAR" />
    <result column="activity_place" property="activityPlace" jdbcType="VARCHAR" />
    <result column="picture_id" property="pictureId" jdbcType="VARCHAR" />
    <result column="activity_category" property="activityCategory" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="VARCHAR" />
    <result column="sequence" property="sequence" jdbcType="INTEGER" />
    <result column="createTime" property="createtime" jdbcType="TIMESTAMP" />
    <result column="gather_time" property="gatherTime" jdbcType="VARCHAR" />
    <result column="topics" property="topics" jdbcType="VARCHAR" />
    <result column="speaker" property="speaker" jdbcType="VARCHAR" />
    <result column="attendants" property="attendants" jdbcType="VARCHAR" />
    <result column="module" property="module" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.tj720.admin.model.MipActivity" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    <result column="content" property="content" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    id, activity_name, user_id, publish_time, publisher, org_id, activity_time, activity_place, 
    picture_id, activity_category, status, sequence, createTime, gather_time, topics, 
    speaker, attendants, module
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    content
  </sql>
  <select id="selectByExampleWithBLOBs" resultMap="ResultMapWithBLOBs" parameterType="com.tj720.admin.model.MipActivityExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from mip_activity
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.tj720.admin.model.MipActivityExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from mip_activity
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    select 
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from mip_activity
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    delete from mip_activity
    where id = #{id,jdbcType=VARCHAR}
  </delete>
  <delete id="deleteByExample" parameterType="com.tj720.admin.model.MipActivityExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    delete from mip_activity
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.tj720.admin.model.MipActivity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    insert into mip_activity (id, activity_name, user_id, 
      publish_time, publisher, org_id, 
      activity_time, activity_place, picture_id, 
      activity_category, status, sequence, 
      createTime, gather_time, topics, 
      speaker, attendants, module, 
      content)
    values (#{id,jdbcType=VARCHAR}, #{activityName,jdbcType=VARCHAR}, #{userId,jdbcType=VARCHAR}, 
      #{publishTime,jdbcType=TIMESTAMP}, #{publisher,jdbcType=VARCHAR}, #{orgId,jdbcType=VARCHAR}, 
      #{activityTime,jdbcType=VARCHAR}, #{activityPlace,jdbcType=VARCHAR}, #{pictureId,jdbcType=VARCHAR}, 
      #{activityCategory,jdbcType=INTEGER}, #{status,jdbcType=VARCHAR}, #{sequence,jdbcType=INTEGER}, 
      #{createtime,jdbcType=TIMESTAMP}, #{gatherTime,jdbcType=VARCHAR}, #{topics,jdbcType=VARCHAR}, 
      #{speaker,jdbcType=VARCHAR}, #{attendants,jdbcType=VARCHAR}, #{module,jdbcType=VARCHAR}, 
      #{content,jdbcType=LONGVARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.tj720.admin.model.MipActivity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    insert into mip_activity
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="activityName != null" >
        activity_name,
      </if>
      <if test="userId != null" >
        user_id,
      </if>
      <if test="publishTime != null" >
        publish_time,
      </if>
      <if test="publisher != null" >
        publisher,
      </if>
      <if test="orgId != null" >
        org_id,
      </if>
      <if test="activityTime != null" >
        activity_time,
      </if>
      <if test="activityPlace != null" >
        activity_place,
      </if>
      <if test="pictureId != null" >
        picture_id,
      </if>
      <if test="activityCategory != null" >
        activity_category,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="sequence != null" >
        sequence,
      </if>
      <if test="createtime != null" >
        createTime,
      </if>
      <if test="gatherTime != null" >
        gather_time,
      </if>
      <if test="topics != null" >
        topics,
      </if>
      <if test="speaker != null" >
        speaker,
      </if>
      <if test="attendants != null" >
        attendants,
      </if>
      <if test="module != null" >
        module,
      </if>
      <if test="content != null" >
        content,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="activityName != null" >
        #{activityName,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        #{userId,jdbcType=VARCHAR},
      </if>
      <if test="publishTime != null" >
        #{publishTime,jdbcType=TIMESTAMP},
      </if>
      <if test="publisher != null" >
        #{publisher,jdbcType=TINYINT},
      </if>
      <if test="orgId != null" >
        #{orgId,jdbcType=VARCHAR},
      </if>
      <if test="activityTime != null" >
        #{activityTime,jdbcType=VARCHAR},
      </if>
      <if test="activityPlace != null" >
        #{activityPlace,jdbcType=VARCHAR},
      </if>
      <if test="pictureId != null" >
        #{pictureId,jdbcType=VARCHAR},
      </if>
      <if test="activityCategory != null" >
        #{activityCategory,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        #{status,jdbcType=VARCHAR},
      </if>
      <if test="sequence != null" >
        #{sequence,jdbcType=INTEGER},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="gatherTime != null" >
        #{gatherTime,jdbcType=VARCHAR},
      </if>
      <if test="topics != null" >
        #{topics,jdbcType=VARCHAR},
      </if>
      <if test="speaker != null" >
        #{speaker,jdbcType=VARCHAR},
      </if>
      <if test="attendants != null" >
        #{attendants,jdbcType=VARCHAR},
      </if>
      <if test="module != null" >
        #{module,jdbcType=VARCHAR},
      </if>
      <if test="content != null" >
        #{content,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.tj720.admin.model.MipActivityExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    select count(*) from mip_activity
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    update mip_activity
    <set >
      <if test="record.id != null" >
        id = #{record.id,jdbcType=VARCHAR},
      </if>
      <if test="record.activityName != null" >
        activity_name = #{record.activityName,jdbcType=VARCHAR},
      </if>
      <if test="record.userId != null" >
        user_id = #{record.userId,jdbcType=VARCHAR},
      </if>
      <if test="record.publishTime != null" >
        publish_time = #{record.publishTime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.publisher != null" >
        publisher = #{record.publisher,jdbcType=TINYINT},
      </if>
      <if test="record.orgId != null" >
        org_id = #{record.orgId,jdbcType=VARCHAR},
      </if>
      <if test="record.activityTime != null" >
        activity_time = #{record.activityTime,jdbcType=VARCHAR},
      </if>
      <if test="record.activityPlace != null" >
        activity_place = #{record.activityPlace,jdbcType=VARCHAR},
      </if>
      <if test="record.pictureId != null" >
        picture_id = #{record.pictureId,jdbcType=VARCHAR},
      </if>
      <if test="record.activityCategory != null" >
        activity_category = #{record.activityCategory,jdbcType=INTEGER},
      </if>
      <if test="record.status != null" >
        status = #{record.status,jdbcType=VARCHAR},
      </if>
      <if test="record.sequence != null" >
        sequence = #{record.sequence,jdbcType=INTEGER},
      </if>
      <if test="record.createtime != null" >
        createTime = #{record.createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="record.gatherTime != null" >
        gather_time = #{record.gatherTime,jdbcType=VARCHAR},
      </if>
      <if test="record.topics != null" >
        topics = #{record.topics,jdbcType=VARCHAR},
      </if>
      <if test="record.speaker != null" >
        speaker = #{record.speaker,jdbcType=VARCHAR},
      </if>
      <if test="record.attendants != null" >
        attendants = #{record.attendants,jdbcType=VARCHAR},
      </if>
      <if test="record.module != null" >
        module = #{record.module,jdbcType=VARCHAR},
      </if>
      <if test="record.content != null" >
        content = #{record.content,jdbcType=LONGVARCHAR},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExampleWithBLOBs" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    update mip_activity
    set id = #{record.id,jdbcType=VARCHAR},
      activity_name = #{record.activityName,jdbcType=VARCHAR},
      user_id = #{record.userId,jdbcType=VARCHAR},
      publish_time = #{record.publishTime,jdbcType=TIMESTAMP},
      publisher = #{record.publisher,jdbcType=VARCHAR},
      org_id = #{record.orgId,jdbcType=VARCHAR},
      activity_time = #{record.activityTime,jdbcType=VARCHAR},
      activity_place = #{record.activityPlace,jdbcType=VARCHAR},
      picture_id = #{record.pictureId,jdbcType=VARCHAR},
      activity_category = #{record.activityCategory,jdbcType=INTEGER},
      status = #{record.status,jdbcType=VARCHAR},
      sequence = #{record.sequence,jdbcType=INTEGER},
      createTime = #{record.createtime,jdbcType=TIMESTAMP},
      gather_time = #{record.gatherTime,jdbcType=VARCHAR},
      topics = #{record.topics,jdbcType=VARCHAR},
      speaker = #{record.speaker,jdbcType=VARCHAR},
      attendants = #{record.attendants,jdbcType=VARCHAR},
      module = #{record.module,jdbcType=VARCHAR},
      content = #{record.content,jdbcType=LONGVARCHAR}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    update mip_activity
    set id = #{record.id,jdbcType=VARCHAR},
      activity_name = #{record.activityName,jdbcType=VARCHAR},
      user_id = #{record.userId,jdbcType=VARCHAR},
      publish_time = #{record.publishTime,jdbcType=TIMESTAMP},
      publisher = #{record.publisher,jdbcType=VARCHAR},
      org_id = #{record.orgId,jdbcType=VARCHAR},
      activity_time = #{record.activityTime,jdbcType=VARCHAR},
      activity_place = #{record.activityPlace,jdbcType=VARCHAR},
      picture_id = #{record.pictureId,jdbcType=VARCHAR},
      activity_category = #{record.activityCategory,jdbcType=INTEGER},
      status = #{record.status,jdbcType=VARCHAR},
      sequence = #{record.sequence,jdbcType=INTEGER},
      createTime = #{record.createtime,jdbcType=TIMESTAMP},
      gather_time = #{record.gatherTime,jdbcType=VARCHAR},
      topics = #{record.topics,jdbcType=VARCHAR},
      speaker = #{record.speaker,jdbcType=VARCHAR},
      attendants = #{record.attendants,jdbcType=VARCHAR},
      module = #{record.module,jdbcType=VARCHAR}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.tj720.admin.model.MipActivity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    update mip_activity
    <set >
      <if test="activityName != null" >
        activity_name = #{activityName,jdbcType=VARCHAR},
      </if>
      <if test="userId != null" >
        user_id = #{userId,jdbcType=VARCHAR},
      </if>
      <if test="publishTime != null" >
        publish_time = #{publishTime,jdbcType=TIMESTAMP},
      </if>
      <if test="publisher != null" >
        publisher = #{publisher,jdbcType=VARCHAR},
      </if>
      <if test="orgId != null" >
        org_id = #{orgId,jdbcType=VARCHAR},
      </if>
      <if test="activityTime != null" >
        activity_time = #{activityTime,jdbcType=VARCHAR},
      </if>
      <if test="activityPlace != null" >
        activity_place = #{activityPlace,jdbcType=VARCHAR},
      </if>
      <if test="pictureId != null" >
        picture_id = #{pictureId,jdbcType=VARCHAR},
      </if>
      <if test="activityCategory != null" >
        activity_category = #{activityCategory,jdbcType=INTEGER},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=VARCHAR},
      </if>
      <if test="sequence != null" >
        sequence = #{sequence,jdbcType=INTEGER},
      </if>
      <if test="createtime != null" >
        createTime = #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="gatherTime != null" >
        gather_time = #{gatherTime,jdbcType=VARCHAR},
      </if>
      <if test="topics != null" >
        topics = #{topics,jdbcType=VARCHAR},
      </if>
      <if test="speaker != null" >
        speaker = #{speaker,jdbcType=VARCHAR},
      </if>
      <if test="attendants != null" >
        attendants = #{attendants,jdbcType=VARCHAR},
      </if>
      <if test="module != null" >
        module = #{module,jdbcType=VARCHAR},
      </if>
      <if test="content != null" >
        content = #{content,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.tj720.admin.model.MipActivity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    update mip_activity
    set activity_name = #{activityName,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=VARCHAR},
      publish_time = #{publishTime,jdbcType=TIMESTAMP},
      publisher = #{publisher,jdbcType=VARCHAR},
      org_id = #{orgId,jdbcType=VARCHAR},
      activity_time = #{activityTime,jdbcType=VARCHAR},
      activity_place = #{activityPlace,jdbcType=VARCHAR},
      picture_id = #{pictureId,jdbcType=VARCHAR},
      activity_category = #{activityCategory,jdbcType=INTEGER},
      status = #{status,jdbcType=VARCHAR},
      sequence = #{sequence,jdbcType=INTEGER},
      createTime = #{createtime,jdbcType=TIMESTAMP},
      gather_time = #{gatherTime,jdbcType=VARCHAR},
      topics = #{topics,jdbcType=VARCHAR},
      speaker = #{speaker,jdbcType=VARCHAR},
      attendants = #{attendants,jdbcType=VARCHAR},
      module = #{module,jdbcType=VARCHAR},
      content = #{content,jdbcType=LONGVARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tj720.admin.model.MipActivity" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jul 13 13:14:01 CST 2018.
    -->
    update mip_activity
    set activity_name = #{activityName,jdbcType=VARCHAR},
      user_id = #{userId,jdbcType=VARCHAR},
      publish_time = #{publishTime,jdbcType=TIMESTAMP},
      publisher = #{publisher,jdbcType=VARCHAR},
      org_id = #{orgId,jdbcType=VARCHAR},
      activity_time = #{activityTime,jdbcType=VARCHAR},
      activity_place = #{activityPlace,jdbcType=VARCHAR},
      picture_id = #{pictureId,jdbcType=VARCHAR},
      activity_category = #{activityCategory,jdbcType=INTEGER},
      status = #{status,jdbcType=VARCHAR},
      sequence = #{sequence,jdbcType=INTEGER},
      createTime = #{createtime,jdbcType=TIMESTAMP},
      gather_time = #{gatherTime,jdbcType=VARCHAR},
      topics = #{topics,jdbcType=VARCHAR},
      speaker = #{speaker,jdbcType=VARCHAR},
      attendants = #{attendants,jdbcType=VARCHAR},
      module = #{module,jdbcType=VARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  
  <select id="getActivityList" resultType="com.tj720.mip.dto.ActivityDto" >    
    select ms.id as id,ms.status as status,ms.user_id as userId,ms.picture_id as pictureId,ms.content as content,ms.activity_name as activityName,
    ms.publisher as publisher,ms.publish_time as publishTime,ms.activity_category as activityCategory,ms.createTime as createtime,ms.org_id as orgId,
    ms.activity_time as activityTime,ms.activity_place as activityPlace,ms.gather_time as gatherTime,ms.topics as topics,ms.speaker as speaker,
    ms.attendants as attendants, ms.module as module,mo.name as orgName
     ,ms.topics ,ms.gather_time as gatherTime,ms.speaker,ms.attendants,ms.module,ms.message
    from mip_activity ms ,mip_organization mo   
    where  ms.org_id = mo.id  
    <if test="currentOrg != null and orgList != null">
    and (ms.org_id = #{currentOrg}
    </if>
   <if test="orgList != null" >
       	or (ms.org_id in 
       	<foreach collection="orgList" item="item" open="(" close=")" separator="," >
       		#{item}
       	</foreach>
       	and ms.status in('1', '3'))
   </if>
    <if test="currentOrg != null and orgList != null">
    )
    </if>
    <if test="key != null and key != ''">
		and (ms.activity_name like concat('%',#{key},'%') or ms.content like concat('%',#{key},'%'))
	</if>	
    <if test="type != null and type != ''">
		and ms.activity_category = #{type} 
	</if>
	<if test="status != null and status != ''">
		<if test="status == 0">
			<![CDATA[ and ms.status <> '1' ]]> 
		</if>
		<if test="status == 1">
			and ms.status = '1' 
		</if>
	</if>
	<if test="startTime!=null and startTime!=''">
   	 	<![CDATA[ and ms.publish_time  >= #{startTime} ]]> 
    </if>
     <if test="endTime!=null and endTime!=''">
    	<![CDATA[ and ms.publish_time <= #{endTime} ]]> 
     </if>
	ORDER BY if(ms.status='3',0,1), ms.createTime desc
	<if test=" startRow == -1">
		limit #{pageSize}
	</if>
	<if test=" startRow != -1">
		limit #{startRow},#{pageSize}
	</if>
  </select>
  <select id="countActivityList" resultType="java.lang.Integer"  >    
    select count(1)
    from mip_activity ms
    where 1=1 
    <if test="currentOrg != null and orgList != null">
    and (ms.org_id = #{currentOrg}
    </if>
   <if test="orgList != null" >
       	or (ms.org_id in 
       	<foreach collection="orgList" item="item" open="(" close=")" separator="," >
       		#{item}
       	</foreach>
       	and ms.status in('1', '3'))
   </if>
    <if test="currentOrg != null and orgList != null">
    )
    </if>
    <if test="key != null and key != ''">
		and (ms.activity_name like concat('%',#{key},'%') or ms.content like concat('%',#{key},'%'))
	</if>	
    <if test="type != null and type != ''">
		and ms.activity_category = #{type} 
	</if>
	<if test="status != null and status != ''">
		<if test="status == 0">
			<![CDATA[ and ms.status <> '1' ]]> 
		</if>
		<if test="status == 1">
			and ms.status = '1' 
		</if>
	</if>
	<if test="startTime!=null and startTime!=''">
   	 	<![CDATA[ and ms.publish_time  >= #{startTime} ]]> 
    </if>
     <if test="endTime!=null and endTime!=''">
    	<![CDATA[ and ms.publish_time <= #{endTime} ]]> 
     </if>
  </select>
  <update id="publish">
    update mip_activity
    set status = #{status,jdbcType=VARCHAR},
    publisher  = #{userId,jdbcType=VARCHAR},
    publish_time  = #{publishTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  
  
  
  
  <select id="getActivityListByType" resultType="java.util.HashMap">
      select t.* from (
      select a.id as activityId,a.activity_name as activityName,b.category_name as categoryName,a.activity_time as activityTime
       ,a.activity_place as activityPlace,a.content,a.picture_id as picUrl
        ,a.topics ,a.gather_time as gatherTime,a.speaker,a.attendants,a.module      
       from mip_activity a,mip_activity_category b where 
		 a.activity_category = b.id  and a.status = 1	
        <if test="activityCategory != null" >
        	and a.activity_category = #{activityCategory}
     	</if> 
     	<if test="orgid != null">
			AND a.org_id = #{orgid}
		</if>   	
     	order by a.createTime DESC
        <if test=" startRow == -1">
			limit #{pageSize}
		</if>
		<if test=" startRow != -1">
			limit #{startRow},#{pageSize}
		</if>	
		) t 	
        <!-- AND(a.content LIKE #{keywords} OR a.description LIKE #{keywords} OR a.title LIKE #{keywords}) -->
    </select>
    <select id="countActivityListByType" resultType="java.lang.Integer">
        select count(1) from (
      select a.id as activityId,a.activity_name as activityName,b.category_name as categoryName,a.activity_time as activityTime
       ,a.activity_place as activityPlace,a.content,a.picture_id as picUrl
        ,a.topics ,a.gather_time as gatherTime,a.speaker,a.attendants,a.module      
       from mip_activity a,mip_activity_category b where 
		 a.activity_category = b.id  and a.status = 1	
        <if test="activityCategory != null" >
        	and a.activity_category = #{activityCategory}
     	</if> 
     	<if test="orgid != null">
			AND a.org_id = #{orgid}
		</if>   	
     	order by a.createTime DESC
		) t 
        
    </select>
   <select id="getActivityListById" resultType="java.util.HashMap">
       select t.* from (
       select a.id as activityId,a.activity_name as activityName,b.category_name as categoryName,a.activity_time as activityTime
       ,a.activity_place as activityPlace,a.content,a.picture_id as picUrl
       ,a.topics ,a.gather_time as gatherTime,a.speaker,a.attendants,a.module        
       from mip_activity a,mip_activity_category b where 
		 a.activity_category = b.id 				
        <if test="activityId != null" >
        	and a.id = #{activityId}
     	</if>   	
     	order by a.createTime DESC     
     	) t 
        <!-- AND(a.content LIKE #{keywords} OR a.description LIKE #{keywords} OR a.title LIKE #{keywords}) -->
    </select>
    
    <!-- 全文检索 -->
    <select id="fullTextSearch" resultType="com.tj720.mip.dto.FullTextSearchDto">
    SELECT distinct(d.id),d.name,d.type,d.url FROM  
    (  
        SELECT  oci.id as id,oci.name as name,oci.description as content,oci.id as url, 1 AS type  
            FROM  mip_open_collection_info oci  
		UNION  
		SELECT  mo.id as id,mo.name as name,mbi.museum_description as content,mo.id as url,2 AS type  
			FROM  bj_museum_base_info mbi,mip_organization mo
			where mbi.museum_id = mo.id and mo.org_type_id = 3
		UNION 
		SELECT  s.id as id ,s.headline as name,s.content as content,s.id as url,3 AS type  
			FROM  mip_spreadtrum s  where s.status = 1 
		UNION
        SELECT  a.id as id, a.viName as name, a.viIntro as content,a.viPCUrl as url, 4 AS type
        	FROM  mip_virtual_exibition_hall a where a.status = 1
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,a.id as url, 5 AS type  
        	FROM  cms_article  a ,cms_subject s
        	where a.subject_id = s.id and a.status = 2 and (s.unique_name = 'xwdt' or s.unique_name = 'tzgg')
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,ma.att_path as url, 6 AS type  
        	FROM  cms_article  a ,cms_subject s,mip_attachment ma
        	where a.subject_id = s.id and a.status = 2 and s.unique_name = 'xssk' and a.pdf_url = ma.att_id
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,a.id as url, 7 AS type  
        	FROM  cms_article  a ,cms_subject s
        	where a.subject_id = s.id and a.status = 2 and s.unique_name = 'xslw'
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,a.id as url, 8 AS type  
        	FROM  cms_article  a ,cms_subject s
        	where a.subject_id = s.id and a.status = 2 and s.unique_name = 'zjwt'
        UNION
        SELECT  a.id as id, a.activity_name as name, a.content as content ,a.id as url, 9 AS type
        	FROM  mip_activity a where a.status = 1 and a.activity_category = 2
        UNION
        SELECT  a.id as id, a.activity_name as name, a.content as content ,a.id as url, 10 AS type
        	FROM  mip_activity a where a.status = 1 and a.activity_category = 1 
    ) d 
	WHERE  1=1	
	<if test="type != null">
		and d.type = #{type}
	</if> 
	<if test="key != null">
		and (d.name like concat('%',#{key},'%') or d.content like concat('%',#{key},'%'))
	</if> 
	ORDER BY  d.type ASC    
	<if test=" startRow == -1">
		limit #{pageSize}
	</if>
	<if test=" startRow != -1">
		limit #{startRow},#{pageSize}
	</if>
  </select>
   <select id="countFullTextSearch" resultType="java.lang.Integer" >
		select count(distinct d.id) from
    (  
        SELECT  oci.id as id,oci.name as name,oci.description as content,oci.id as url, 1 AS type  
            FROM  mip_open_collection_info oci  
		UNION  
		SELECT  mo.id as id,mo.name as name,mbi.museum_description as content,mo.id as url,2 AS type  
			FROM  bj_museum_base_info mbi,mip_organization mo
			where mbi.museum_id = mo.id and mo.org_type_id = 3
		UNION 
		SELECT  s.id as id ,s.headline as name,s.content as content,s.id as url,3 AS type  
			FROM  mip_spreadtrum s  where s.status = 1 
		UNION
        SELECT  a.id as id, a.viName as name, a.viIntro as content,a.viPCUrl as url, 4 AS type
        	FROM  mip_virtual_exibition_hall a where a.status = 1
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,a.id as url, 5 AS type  
        	FROM  cms_article  a ,cms_subject s
        	where a.subject_id = s.id and a.status = 2 and (s.unique_name = 'xwdt' or s.unique_name = 'tzgg')
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,ma.att_path as url, 6 AS type  
        	FROM  cms_article  a ,cms_subject s,mip_attachment ma
        	where a.subject_id = s.id and a.status = 2 and s.unique_name = 'xssk' and a.pdf_url = ma.att_id
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,a.id as url, 7 AS type  
        	FROM  cms_article  a ,cms_subject s
        	where a.subject_id = s.id and a.status = 2 and s.unique_name = 'xslw'
        UNION  
		SELECT  a.id as id, a.title as name, a.content as content,a.id as url, 8 AS type  
        	FROM  cms_article  a ,cms_subject s
        	where a.subject_id = s.id and a.status = 2 and s.unique_name = 'zjwt'
        UNION
        SELECT  a.id as id, a.activity_name as name, a.content as content ,a.id as url, 9 AS type
        	FROM  mip_activity a where a.status = 1 and a.activity_category = 2
        UNION
        SELECT  a.id as id, a.activity_name as name, a.content as content ,a.id as url, 10 AS type
        	FROM  mip_activity a where a.status = 1 and a.activity_category = 1 
    ) d  
	WHERE  1=1	
	<if test="type != null">
		and d.type = #{type}
	</if> 
	<if test="key != null">
		and (d.name like concat('%',#{key},'%') or d.content like concat('%',#{key},'%'))
	</if> 
	</select>
	
	
</mapper>