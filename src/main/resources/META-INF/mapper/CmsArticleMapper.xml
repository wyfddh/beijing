<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tj720.admin.dao.map.CmsArticleMapper" >
  <resultMap id="BaseResultMap" type="com.tj720.admin.model.CmsArticle" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="CHAR" />
    <result column="subject_id" property="subjectId" jdbcType="VARCHAR" />
    <result column="dn" property="dn" jdbcType="VARCHAR" />
    <result column="full_name" property="fullName" jdbcType="VARCHAR" />
    <result column="status" property="status" jdbcType="CHAR" />
    <result column="title" property="title" jdbcType="VARCHAR" />
    <result column="description" property="description" jdbcType="VARCHAR" />
    <result column="author" property="author" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="VARCHAR" />
    <result column="modify_time" property="modifyTime" jdbcType="VARCHAR" />
    <result column="publish_time" property="publishTime" jdbcType="VARCHAR" />
    <result column="title_image_src" property="titleImageSrc" jdbcType="VARCHAR" />
    <result column="vedio_url" property="vedioUrl" jdbcType="VARCHAR" />
    <result column="source" property="source" jdbcType="VARCHAR" />
    <result column="pos" property="pos" jdbcType="INTEGER" />
    <result column="view_counts" property="viewCounts" jdbcType="INTEGER" />
    <result column="can_comment" property="canComment" jdbcType="CHAR" />
    <result column="comment_counts" property="commentCounts" jdbcType="INTEGER" />
    <result column="mark" property="mark" jdbcType="VARCHAR" />
    <result column="publisher" property="publisher" jdbcType="VARCHAR" />
    <result column="pdf_url" property="pdfUrl" jdbcType="VARCHAR" />
    <result column="audio_url" property="audioUrl" jdbcType="VARCHAR" />
    <result column="publish_type" property="publishType" jdbcType="VARCHAR" />
    <result column="message" property="message" jdbcType="VARCHAR" />
  </resultMap>
  <resultMap id="ResultMapWithBLOBs" type="com.tj720.admin.model.CmsArticle" extends="BaseResultMap" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    <result column="content" property="content" jdbcType="LONGVARCHAR" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <if test="fields == null" >
    	id, type, subject_id, dn, full_name, status, title, description, author, create_time, 
    	modify_time, publish_time, title_image_src, vedio_url, source, pos, view_counts, 
    	can_comment, comment_counts, mark, publisher, pdf_url, audio_url, publish_type
    </if>
    <if test="fields != null" >
      ${fields}
    </if>
  </sql>
  <sql id="Blob_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    content
  </sql>
  <select id="selectByExampleWithBLOBs" resultMap="ResultMapWithBLOBs" parameterType="com.tj720.admin.model.CmsArticleExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    ,
    <include refid="Blob_Column_List" />
    from cms_article
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.tj720.admin.model.CmsArticleExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from cms_article
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
    <if test="startRow != null" >
      limit #{startRow} , #{pageSize}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="ResultMapWithBLOBs" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    select 
    id, type, subject_id, dn, full_name, status, title, description, author, create_time, 
    	modify_time, publish_time, title_image_src, vedio_url, source, pos, view_counts, 
    	can_comment, comment_counts, mark, publisher, pdf_url, audio_url, publish_type
    ,
    <include refid="Blob_Column_List" />
    from cms_article
    where id = #{id,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    delete from cms_article
    where id = #{id,jdbcType=VARCHAR}
  </delete>
  <delete id="deleteByExample" parameterType="com.tj720.admin.model.CmsArticleExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    delete from cms_article
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.tj720.admin.model.CmsArticle" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    insert into cms_article (id, type, subject_id, 
      dn, full_name, status, 
      title, description, author, 
      create_time, modify_time, publish_time, 
      title_image_src, vedio_url, source, 
      pos, view_counts, can_comment, 
      comment_counts, mark, publisher, 
      pdf_url, audio_url, publish_type, 
      content)
    values (#{id,jdbcType=VARCHAR}, #{type,jdbcType=CHAR}, #{subjectId,jdbcType=VARCHAR}, 
      #{dn,jdbcType=VARCHAR}, #{fullName,jdbcType=VARCHAR}, #{status,jdbcType=CHAR}, 
      #{title,jdbcType=VARCHAR}, #{description,jdbcType=VARCHAR}, #{author,jdbcType=VARCHAR}, 
      #{createTime,jdbcType=VARCHAR}, #{modifyTime,jdbcType=VARCHAR}, #{publishTime,jdbcType=VARCHAR}, 
      #{titleImageSrc,jdbcType=VARCHAR}, #{vedioUrl,jdbcType=VARCHAR}, #{source,jdbcType=VARCHAR}, 
      #{pos,jdbcType=INTEGER}, #{viewCounts,jdbcType=INTEGER}, #{canComment,jdbcType=CHAR}, 
      #{commentCounts,jdbcType=INTEGER}, #{mark,jdbcType=VARCHAR}, #{publisher,jdbcType=VARCHAR}, 
      #{pdfUrl,jdbcType=VARCHAR}, #{audioUrl,jdbcType=VARCHAR}, #{publishType,jdbcType=VARCHAR}, 
      #{content,jdbcType=LONGVARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.tj720.admin.model.CmsArticle" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    insert into cms_article
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        id,
      </if>
      <if test="type != null" >
        type,
      </if>
      <if test="subjectId != null" >
        subject_id,
      </if>
      <if test="dn != null" >
        dn,
      </if>
      <if test="fullName != null" >
        full_name,
      </if>
      <if test="status != null" >
        status,
      </if>
      <if test="title != null" >
        title,
      </if>
      <if test="description != null" >
        description,
      </if>
      <if test="author != null" >
        author,
      </if>
      <if test="createTime != null" >
        create_time,
      </if>
      <if test="modifyTime != null" >
        modify_time,
      </if>
      <if test="publishTime != null" >
        publish_time,
      </if>
      <if test="titleImageSrc != null" >
        title_image_src,
      </if>
      <if test="vedioUrl != null" >
        vedio_url,
      </if>
      <if test="source != null" >
        source,
      </if>
      <if test="pos != null" >
        pos,
      </if>
      <if test="viewCounts != null" >
        view_counts,
      </if>
      <if test="canComment != null" >
        can_comment,
      </if>
      <if test="commentCounts != null" >
        comment_counts,
      </if>
      <if test="mark != null" >
        mark,
      </if>
      <if test="publisher != null" >
        publisher,
      </if>
      <if test="pdfUrl != null" >
        pdf_url,
      </if>
      <if test="audioUrl != null" >
        audio_url,
      </if>
      <if test="publishType != null" >
        publish_type,
      </if>
      <if test="content != null" >
        content,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=VARCHAR},
      </if>
      <if test="type != null" >
        #{type,jdbcType=CHAR},
      </if>
      <if test="subjectId != null" >
        #{subjectId,jdbcType=VARCHAR},
      </if>
      <if test="dn != null" >
        #{dn,jdbcType=VARCHAR},
      </if>
      <if test="fullName != null" >
        #{fullName,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        #{status,jdbcType=CHAR},
      </if>
      <if test="title != null" >
        #{title,jdbcType=VARCHAR},
      </if>
      <if test="description != null" >
        #{description,jdbcType=VARCHAR},
      </if>
      <if test="author != null" >
        #{author,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="modifyTime != null" >
        #{modifyTime,jdbcType=VARCHAR},
      </if>
      <if test="publishTime != null" >
        #{publishTime,jdbcType=VARCHAR},
      </if>
      <if test="titleImageSrc != null" >
        #{titleImageSrc,jdbcType=VARCHAR},
      </if>
      <if test="vedioUrl != null" >
        #{vedioUrl,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        #{source,jdbcType=VARCHAR},
      </if>
      <if test="pos != null" >
        #{pos,jdbcType=INTEGER},
      </if>
      <if test="viewCounts != null" >
        #{viewCounts,jdbcType=INTEGER},
      </if>
      <if test="canComment != null" >
        #{canComment,jdbcType=CHAR},
      </if>
      <if test="commentCounts != null" >
        #{commentCounts,jdbcType=INTEGER},
      </if>
      <if test="mark != null" >
        #{mark,jdbcType=VARCHAR},
      </if>
      <if test="publisher != null" >
        #{publisher,jdbcType=VARCHAR},
      </if>
      <if test="pdfUrl != null" >
        #{pdfUrl,jdbcType=VARCHAR},
      </if>
      <if test="audioUrl != null" >
        #{audioUrl,jdbcType=VARCHAR},
      </if>
      <if test="publishType != null" >
        #{publishType,jdbcType=VARCHAR},
      </if>
      <if test="content != null" >
        #{content,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.tj720.admin.model.CmsArticleExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    select count(*) from cms_article
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <select id="selectMuseumArticleByKeywords" resultType="com.tj720.admin.dto.ArticleDto">
        SELECT a.id,a.title AS headline,a.description,a.title_image_src AS picUrl,a.content,a.create_time AS createTime from cms_article a,cms_subject s WHERE a.subject_id=s.id AND s.type=#{type} AND a.status=2 AND(a.content LIKE #{keywords} OR a.description LIKE #{keywords} OR a.title LIKE #{keywords})
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    update cms_article
    <set >
      <if test="record.id != null" >
        id = #{record.id,jdbcType=VARCHAR},
      </if>
      <if test="record.type != null" >
        type = #{record.type,jdbcType=CHAR},
      </if>
      <if test="record.subjectId != null" >
        subject_id = #{record.subjectId,jdbcType=VARCHAR},
      </if>
      <if test="record.dn != null" >
        dn = #{record.dn,jdbcType=VARCHAR},
      </if>
      <if test="record.fullName != null" >
        full_name = #{record.fullName,jdbcType=VARCHAR},
      </if>
      <if test="record.status != null" >
        status = #{record.status,jdbcType=CHAR},
      </if>
      <if test="record.title != null" >
        title = #{record.title,jdbcType=VARCHAR},
      </if>
      <if test="record.description != null" >
        description = #{record.description,jdbcType=VARCHAR},
      </if>
      <if test="record.author != null" >
        author = #{record.author,jdbcType=VARCHAR},
      </if>
      <if test="record.createTime != null" >
        create_time = #{record.createTime,jdbcType=VARCHAR},
      </if>
      <if test="record.modifyTime != null" >
        modify_time = #{record.modifyTime,jdbcType=VARCHAR},
      </if>
      <if test="record.publishTime != null" >
        publish_time = #{record.publishTime,jdbcType=VARCHAR},
      </if>
      <if test="record.titleImageSrc != null" >
        title_image_src = #{record.titleImageSrc,jdbcType=VARCHAR},
      </if>
      <if test="record.vedioUrl != null" >
        vedio_url = #{record.vedioUrl,jdbcType=VARCHAR},
      </if>
      <if test="record.source != null" >
        source = #{record.source,jdbcType=VARCHAR},
      </if>
      <if test="record.pos != null" >
        pos = #{record.pos,jdbcType=INTEGER},
      </if>
      <if test="record.viewCounts != null" >
        view_counts = #{record.viewCounts,jdbcType=INTEGER},
      </if>
      <if test="record.canComment != null" >
        can_comment = #{record.canComment,jdbcType=CHAR},
      </if>
      <if test="record.commentCounts != null" >
        comment_counts = #{record.commentCounts,jdbcType=INTEGER},
      </if>
      <if test="record.mark != null" >
        mark = #{record.mark,jdbcType=VARCHAR},
      </if>
      <if test="record.publisher != null" >
        publisher = #{record.publisher,jdbcType=VARCHAR},
      </if>
      <if test="record.pdfUrl != null" >
        pdf_url = #{record.pdfUrl,jdbcType=VARCHAR},
      </if>
      <if test="record.audioUrl != null" >
        audio_url = #{record.audioUrl,jdbcType=VARCHAR},
      </if>
      <if test="record.publishType != null" >
        publish_type = #{record.publishType,jdbcType=VARCHAR},
      </if>
      <if test="record.content != null" >
        content = #{record.content,jdbcType=LONGVARCHAR},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExampleWithBLOBs" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    update cms_article
    set id = #{record.id,jdbcType=VARCHAR},
      type = #{record.type,jdbcType=CHAR},
      subject_id = #{record.subjectId,jdbcType=VARCHAR},
      dn = #{record.dn,jdbcType=VARCHAR},
      full_name = #{record.fullName,jdbcType=VARCHAR},
      status = #{record.status,jdbcType=CHAR},
      title = #{record.title,jdbcType=VARCHAR},
      description = #{record.description,jdbcType=VARCHAR},
      author = #{record.author,jdbcType=VARCHAR},
      create_time = #{record.createTime,jdbcType=VARCHAR},
      modify_time = #{record.modifyTime,jdbcType=VARCHAR},
      publish_time = #{record.publishTime,jdbcType=VARCHAR},
      title_image_src = #{record.titleImageSrc,jdbcType=VARCHAR},
      vedio_url = #{record.vedioUrl,jdbcType=VARCHAR},
      source = #{record.source,jdbcType=VARCHAR},
      pos = #{record.pos,jdbcType=INTEGER},
      view_counts = #{record.viewCounts,jdbcType=INTEGER},
      can_comment = #{record.canComment,jdbcType=CHAR},
      comment_counts = #{record.commentCounts,jdbcType=INTEGER},
      mark = #{record.mark,jdbcType=VARCHAR},
      publisher = #{record.publisher,jdbcType=VARCHAR},
      pdf_url = #{record.pdfUrl,jdbcType=VARCHAR},
      audio_url = #{record.audioUrl,jdbcType=VARCHAR},
      publish_type = #{record.publishType,jdbcType=VARCHAR},
      content = #{record.content,jdbcType=LONGVARCHAR}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    update cms_article
    set id = #{record.id,jdbcType=VARCHAR},
      type = #{record.type,jdbcType=CHAR},
      subject_id = #{record.subjectId,jdbcType=VARCHAR},
      dn = #{record.dn,jdbcType=VARCHAR},
      full_name = #{record.fullName,jdbcType=VARCHAR},
      status = #{record.status,jdbcType=CHAR},
      title = #{record.title,jdbcType=VARCHAR},
      description = #{record.description,jdbcType=VARCHAR},
      author = #{record.author,jdbcType=VARCHAR},
      create_time = #{record.createTime,jdbcType=VARCHAR},
      modify_time = #{record.modifyTime,jdbcType=VARCHAR},
      publish_time = #{record.publishTime,jdbcType=VARCHAR},
      title_image_src = #{record.titleImageSrc,jdbcType=VARCHAR},
      vedio_url = #{record.vedioUrl,jdbcType=VARCHAR},
      source = #{record.source,jdbcType=VARCHAR},
      pos = #{record.pos,jdbcType=INTEGER},
      view_counts = #{record.viewCounts,jdbcType=INTEGER},
      can_comment = #{record.canComment,jdbcType=CHAR},
      comment_counts = #{record.commentCounts,jdbcType=INTEGER},
      mark = #{record.mark,jdbcType=VARCHAR},
      publisher = #{record.publisher,jdbcType=VARCHAR},
      pdf_url = #{record.pdfUrl,jdbcType=VARCHAR},
      audio_url = #{record.audioUrl,jdbcType=VARCHAR},
      publish_type = #{record.publishType,jdbcType=VARCHAR}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.tj720.admin.model.CmsArticle" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    update cms_article
    <set >
      <if test="type != null" >
        type = #{type,jdbcType=CHAR},
      </if>
      <if test="subjectId != null" >
        subject_id = #{subjectId,jdbcType=VARCHAR},
      </if>
      <if test="dn != null" >
        dn = #{dn,jdbcType=VARCHAR},
      </if>
      <if test="fullName != null" >
        full_name = #{fullName,jdbcType=VARCHAR},
      </if>
      <if test="status != null" >
        status = #{status,jdbcType=CHAR},
      </if>
      <if test="title != null" >
        title = #{title,jdbcType=VARCHAR},
      </if>
      <if test="description != null" >
        description = #{description,jdbcType=VARCHAR},
      </if>
      <if test="author != null" >
        author = #{author,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null" >
        create_time = #{createTime,jdbcType=VARCHAR},
      </if>
      <if test="modifyTime != null" >
        modify_time = #{modifyTime,jdbcType=VARCHAR},
      </if>
      <if test="publishTime != null" >
        publish_time = #{publishTime,jdbcType=VARCHAR},
      </if>
      <if test="titleImageSrc != null" >
        title_image_src = #{titleImageSrc,jdbcType=VARCHAR},
      </if>
      <if test="vedioUrl != null" >
        vedio_url = #{vedioUrl,jdbcType=VARCHAR},
      </if>
      <if test="source != null" >
        source = #{source,jdbcType=VARCHAR},
      </if>
      <if test="pos != null" >
        pos = #{pos,jdbcType=INTEGER},
      </if>
      <if test="viewCounts != null" >
        view_counts = #{viewCounts,jdbcType=INTEGER},
      </if>
      <if test="canComment != null" >
        can_comment = #{canComment,jdbcType=CHAR},
      </if>
      <if test="commentCounts != null" >
        comment_counts = #{commentCounts,jdbcType=INTEGER},
      </if>
      <if test="mark != null" >
        mark = #{mark,jdbcType=VARCHAR},
      </if>
      <if test="publisher != null" >
        publisher = #{publisher,jdbcType=VARCHAR},
      </if>
      <if test="pdfUrl != null" >
        pdf_url = #{pdfUrl,jdbcType=VARCHAR},
      </if>
      <if test="audioUrl != null" >
        audio_url = #{audioUrl,jdbcType=VARCHAR},
      </if>
      <if test="publishType != null" >
        publish_type = #{publishType,jdbcType=VARCHAR},
      </if>
      <if test="content != null" >
        content = #{content,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKeyWithBLOBs" parameterType="com.tj720.admin.model.CmsArticle" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    update cms_article
    set type = #{type,jdbcType=CHAR},
      subject_id = #{subjectId,jdbcType=VARCHAR},
      dn = #{dn,jdbcType=VARCHAR},
      full_name = #{fullName,jdbcType=VARCHAR},
      status = #{status,jdbcType=CHAR},
      title = #{title,jdbcType=VARCHAR},
      description = #{description,jdbcType=VARCHAR},
      author = #{author,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=VARCHAR},
      modify_time = #{modifyTime,jdbcType=VARCHAR},
      publish_time = #{publishTime,jdbcType=VARCHAR},
      title_image_src = #{titleImageSrc,jdbcType=VARCHAR},
      vedio_url = #{vedioUrl,jdbcType=VARCHAR},
      source = #{source,jdbcType=VARCHAR},
      pos = #{pos,jdbcType=INTEGER},
      view_counts = #{viewCounts,jdbcType=INTEGER},
      can_comment = #{canComment,jdbcType=CHAR},
      comment_counts = #{commentCounts,jdbcType=INTEGER},
      mark = #{mark,jdbcType=VARCHAR},
      publisher = #{publisher,jdbcType=VARCHAR},
      pdf_url = #{pdfUrl,jdbcType=VARCHAR},
      audio_url = #{audioUrl,jdbcType=VARCHAR},
      publish_type = #{publishType,jdbcType=VARCHAR},
      content = #{content,jdbcType=LONGVARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.tj720.admin.model.CmsArticle" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Apr 13 14:15:05 CST 2018.
    -->
    update cms_article
    set type = #{type,jdbcType=CHAR},
      subject_id = #{subjectId,jdbcType=VARCHAR},
      dn = #{dn,jdbcType=VARCHAR},
      full_name = #{fullName,jdbcType=VARCHAR},
      status = #{status,jdbcType=CHAR},
      title = #{title,jdbcType=VARCHAR},
      description = #{description,jdbcType=VARCHAR},
      author = #{author,jdbcType=VARCHAR},
      create_time = #{createTime,jdbcType=VARCHAR},
      modify_time = #{modifyTime,jdbcType=VARCHAR},
      publish_time = #{publishTime,jdbcType=VARCHAR},
      title_image_src = #{titleImageSrc,jdbcType=VARCHAR},
      vedio_url = #{vedioUrl,jdbcType=VARCHAR},
      source = #{source,jdbcType=VARCHAR},
      pos = #{pos,jdbcType=INTEGER},
      view_counts = #{viewCounts,jdbcType=INTEGER},
      can_comment = #{canComment,jdbcType=CHAR},
      comment_counts = #{commentCounts,jdbcType=INTEGER},
      mark = #{mark,jdbcType=VARCHAR},
      publisher = #{publisher,jdbcType=VARCHAR},
      pdf_url = #{pdfUrl,jdbcType=VARCHAR},
      audio_url = #{audioUrl,jdbcType=VARCHAR},
      publish_type = #{publishType,jdbcType=VARCHAR},
      content = #{content,jdbcType=LONGVARCHAR}
    where id = #{id,jdbcType=VARCHAR}
  </update>
  
   <select id="getArticleListByKey" resultMap="BaseResultMap">
        SELECT a.id, a.type, a.subject_id, a.dn, a.full_name, a.status, a.title, a.description, a.author, a.create_time, 
    	a.modify_time, a.publish_time, a.title_image_src, a.vedio_url, a.source, a.pos, a.view_counts, 
    	a.can_comment, a.comment_counts, a.mark, b.name as publisher, ifnull(a.pdf_url,'') as pdfUrl, a.audio_url, a.publish_type,a.message
        from cms_article a
        	left join mip_organization b on(a.publisher=b.id)
        WHERE 1=1
        <![CDATA[ and a.status <> '0' ]]> 
        <if test="key != null and key != ''" >
        	AND a.title like concat('%', #{key}, '%') 
     	</if>
        <if test="status != null and status != ''" >
        	AND a.status = #{status} 
     	</if>
        <if test="orgId != null and orgId != ''" >
        	AND a.publisher=#{orgId} 
     	</if>
     	<if test="orgList != null and currentOrg != null and currentOrg != ''" >
     	AND (
     		<if test="currentOrg != null and currentOrg != ''">
     			a.publisher = #{currentOrg}
     		</if>
     	</if>
     	<if test="orgList != null" >
        	or (a.publisher in 
        	<foreach collection="orgList" item="item" open="(" close=")" separator="," >
        		#{item}
        	</foreach>
        	and a.status in ('2','3'))
     	</if>
     	<if test="orgList != null and currentOrg != null and currentOrg != ''" >
     	)
     	</if>
        <if test="subjectId != null and subjectId != ''" >
        	AND a.subject_id=#{subjectId}
     	</if>
        
     	order by if(a.status='3',0,1), a.create_time DESC
        <if test=" startRow == -1">
			limit #{pageSize}
		</if>
		<if test=" startRow != -1">
			limit #{startRow},#{pageSize}
		</if>
    </select>
   <select id="countArticleListByKey" resultType="java.lang.Integer">
        SELECT count(1)
        from cms_article a
        WHERE 1=1
        <![CDATA[ and a.status <> '0' ]]> 
        <if test="key != null and key != ''" >
        	AND a.title like #{key} 
     	</if>
        <if test="status != null and status != ''" >
        	AND a.status = #{status} 
     	</if>
        <if test="orgId != null and orgId != ''" >
        	AND a.publisher=#{orgId} 
     	</if>
        <if test="subjectId != null" >
        	AND a.subject_id=#{subjectId}
     	</if>
     	<if test="orgList != null and currentOrg != null and currentOrg != ''" >
     	AND (
     		<if test="currentOrg != null and currentOrg != ''">
     			(a.publisher = #{currentOrg} and a.status in ('1','2','4'))
     		</if>
     	</if>
     	<if test="orgList != null" >
        	or (a.publisher in 
        	<foreach collection="orgList" item="item" open="(" close=")" separator="," >
        		#{item}
        	</foreach>
        	and a.status in ('2','3'))
     	</if>
     	<if test="orgList != null and currentOrg != null and currentOrg != ''" >
     	)
     	</if>
    </select>
   <select id="getArticleListByType" resultType="com.tj720.admin.dto.ArticleDto">
        select t.*, ma.att_path as pdfUrl
        from (
        SELECT a.id,a.title AS headline,ifnull(a.title_image_src,'') AS picUrl,a.description,ifnull(a.author,'') as author,
        o.name as publisher,s.unique_name as uniqueName,      
        a.content,a.publish_time AS createTime 
        ,a.view_counts as viewCounts,ifnull(a.pdf_url,'') as pdfUrl
        from cms_article a,cms_subject s,mip_organization o
        WHERE a.subject_id = s.id AND a.status=2   
       and o.id = a.publisher and o.status = 1     
        <if test="subjectId != null" >
        	AND a.subject_id=#{subjectId} 
     	</if>
     	order by a.publish_time DESC
        <if test=" startRow == -1">
			limit #{pageSize}
		</if>
		<if test=" startRow != -1">
			limit #{startRow},#{pageSize}
		</if>
		) t 
		LEFT JOIN  mip_attachment ma on (ma.att_id = t.pdfUrl)
        <!-- AND(a.content LIKE #{keywords} OR a.description LIKE #{keywords} OR a.title LIKE #{keywords}) -->
    </select>
    <select id="countArticlesByType" resultType="java.lang.Integer" >
		select count(1)
        from (
        SELECT a.id,a.title AS headline,ifnull(a.title_image_src,'') AS picUrl,a.description,ifnull(a.author,'') as author,
        o.name as publisher,s.unique_name as uniqueName,      
        a.content,a.publish_time AS createTime 
        ,a.view_counts as viewCounts,ifnull(a.pdf_url,'') as pdfUrl
        from cms_article a,cms_subject s,mip_organization o
        WHERE a.subject_id = s.id AND a.status=2  
        and o.id = a.publisher and o.status = 1        
        <if test="subjectId != null" >
        	AND a.subject_id=#{subjectId} 
     	</if>
     	order by a.publish_time DESC
		) t  
		LEFT JOIN  mip_attachment ma on (ma.att_id = t.pdfUrl)       
	</select>
	
  <select id="getArticleById" resultType="com.tj720.admin.dto.ArticleDto">
        select t.*, ma.att_path as pdfUrl
         from (
        SELECT a.id,a.title AS headline,a.title_image_src AS picUrl,a.content,a.publish_time AS createTime,a.description,
        o.name as publisher,ifnull(a.author,'') as author,
        s.unique_name as uniqueName,
        a.view_counts as viewCounts
        ,ifnull(a.pdf_url,'') as pdfUrl
        from cms_article a,mip_organization o,cms_subject s
        WHERE 1=1 and s.id = a.subject_id    
        and o.id = a.publisher and o.status = 1    
        <if test="id != null" >
        	AND a.id=#{id} 
     	</if>        
     	) t LEFT JOIN  mip_attachment ma on (ma.att_id = t.pdfUrl)
    </select>
    <select id="getOtherArticleByIdAndType" resultType="com.tj720.admin.dto.ArticleDto">
       select t.*,ma.att_path as pdfUrl
        from (
        SELECT a.id,a.title AS headline,a.title_image_src AS picUrl,a.description,ifnull(a.author,'') as author,
        o.name as publisher,s.unique_name as uniqueName,
        a.content,a.publish_time AS createTime,a.view_counts as viewCounts
        ,ifnull(a.pdf_url,'') as pdfUrl
        from cms_article a,cms_subject s,mip_organization o
        WHERE a.subject_id=s.id AND a.status=2
        and o.id = a.publisher and o.status = 1 
        <if test="uniqueName != null" >
        	AND s.unique_name=#{uniqueName} 
     	</if>
     	 <if test="id != null" >
        	AND a.id != #{id}
     	</if>
     	order by a.publish_time DESC   
     	<if test=" startRow == -1">
			limit #{pageSize}
		</if>
		<if test=" startRow != -1">
			limit #{startRow},#{pageSize}
		</if> 
     	) t 
     	LEFT JOIN  mip_attachment ma on (ma.att_id = t.pdfUrl)
    </select>
    
    <select id="countOtherArticleByIdAndType" resultType="java.lang.Integer">
       select count(1)
        from (
        SELECT a.id,a.title AS headline,a.title_image_src AS picUrl,a.description,ifnull(a.author,'') as author,
        o.name as publisher,s.unique_name as uniqueName,
        a.content,a.publish_time AS createTime,a.view_counts as viewCounts
        ,ifnull(a.pdf_url,'') as pdfUrl
        from cms_article a,cms_subject s,mip_organization o
        WHERE a.subject_id=s.id AND a.status=2
        and o.id = a.publisher and o.status = 1 
        <if test="uniqueName != null" >
        	AND s.unique_name=#{uniqueName} 
     	</if>
     	 <if test="id != null" >
        	AND a.id != #{id}
     	</if>
     	order by a.publish_time DESC    
     	) t 
     	LEFT JOIN  mip_attachment ma on (ma.att_id = t.pdfUrl)
    </select>
    <select id="getChlidrenSubjectByUniqueName"  resultType="java.util.HashMap">
        select c.id as subjectId,c.unique_name as uniqueName from cms_subject c where 
        c.f_id = (select id from cms_subject  where unique_name = #{uniqueName})    
        order by c.id asc   
    </select>
     <select id="getChlidrenSubjectByUniqueNameContainSelf"  resultType="java.util.HashMap">
        select c.id as subjectId,c.unique_name as uniqueName from cms_subject c where c.id = 
        (select id from cms_subject  where unique_name = #{uniqueName})
        or c.f_id = (select id from cms_subject  where unique_name = #{uniqueName})    
        order by c.id asc   
    </select>
    <select id="countArticlesByUniqueType" resultType="java.lang.Integer" >
		select count(1)
         from (
        SELECT a.id,a.title AS headline,ifnull(a.title_image_src,'') AS picUrl,a.description,o.name as publisher,
        s.unique_name as uniqueName,ifnull(a.author,'') as author,
        ifnull(a.content,'') as content,a.publish_time AS createTime,a.view_counts as viewCounts
        ,ifnull(a.pdf_url,'') as pdfUrl
        from cms_article a,cms_subject s,mip_organization o
        WHERE a.subject_id = s.id AND a.status=2 
         and o.id = a.publisher and o.status = 1         
        <if test="uniqueName != null" >
        	AND s.unique_name=#{uniqueName} 
     	</if>     	
     	<if test="orgid != null">
			AND a.publisher = #{orgid}
		</if>
		order by a.publish_time DESC        
		) t 
		LEFT JOIN  mip_attachment ma on (ma.att_id = t.pdfUrl)      
	</select>
	<select id="getArticleListByUniqueType" resultType="com.tj720.admin.dto.ArticleDto">
        select t.*, ma.att_path as pdfUrl
         from (
        SELECT a.id,a.title AS headline,ifnull(a.title_image_src,'') AS picUrl,a.description,
        o.name as publisher,s.unique_name as uniqueName,ifnull(a.author,'') as author,
        ifnull(a.content,'') as content,a.publish_time AS createTime,a.view_counts as viewCounts
        ,ifnull(a.pdf_url,'') as pdfUrl
        from cms_article a,cms_subject s,mip_organization o
        WHERE a.subject_id = s.id AND a.status=2    
         and o.id = a.publisher and o.status = 1      
        <if test="uniqueName != null" >
        	AND s.unique_name=#{uniqueName} 
     	</if>     	
     	<if test="orgid != null">
			AND a.publisher = #{orgid}
		</if>
		order by a.publish_time DESC
        <if test=" startRow == -1">
			limit #{pageSize}
		</if>
		<if test=" startRow != -1">
			limit #{startRow},#{pageSize}
		</if>
		) t 
		LEFT JOIN  mip_attachment ma on (ma.att_id = t.pdfUrl)
        <!-- AND(a.content LIKE #{keywords} OR a.description LIKE #{keywords} OR a.title LIKE #{keywords}) -->
    </select>

    
    <select id="getCommentByArticleId" resultType="java.util.HashMap">
    		select max(case t.commend_type when '0' then t.count else 0 end) as commendCount,
            max(case t.commend_type when '1' then t.count else 0 end) as middleCount,
            max(case t.commend_type when '2' then t.count else 0 end) as criticismCount
			from 
			(select c.commend_type,count(distinct(c.ipaddress)) as count from cms_comment_count c 
			where 
    		c.article_id = #{articleId}
			group by commend_type) t 
    </select>
    <select id="countCommentByArticleId" resultType="java.lang.Integer">
    		select count(c.commend_type) from cms_comment_count c 
    		where c.article_id = #{articleId}
    		<if test="ipaddress != null and ipaddress != '' ">
    		and c.ipaddress = #{ipaddress}
    		</if>
    		
    </select>
    
    <select id="getCommentByArticleIdAndIp" resultType="java.util.HashMap">
    		select c.commend_type as commendType from cms_comment_count c 
    		where c.article_id = #{articleId}
    		and c.ipaddress = #{ipaddress}
    </select>
    
    <insert id="insertComment">
    		insert into cms_comment_count
    		(
				id,
				article_id,
				ipaddress,
				commend_type,
				create_time
			)
    		values((select case when max(c.id) is null then 1
			else max(c.id)+1 end as id from cms_comment_count c),
			#{articleId},#{ipaddress},#{commendType},#{createTime})
    </insert>
    
    <update id="updateComment">
    	update cms_comment_count
    	set 
    	commend_type = #{commendType})
    	where article_id = #{articleId}
    	and ipaddress = #{ipaddress}
    </update>
    
    <update id="updateSaveData">
        ${sqlStr}
    </update>
    
    
</mapper>